<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Phomemo D30 Printer | Web UI</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/css/bootstrap-dark.min.css">
		<link rel="stylesheet" href="index.css" />
        <link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
        <link rel="manifest" href="/favicon/site.webmanifest">
        <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg" color="#5bbad5">
		<!-- Webfonts for the font family selector -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Libre+Franklin:wght@400;700&family=Oswald:wght@400;700&family=Staatliches:wght@400;700&family=Fredoka:wght@400;700&family=Baloo+2:wght@400;700&family=Libre+Baskerville:wght@400;700&family=JetBrains+Mono:wght@400;700&family=Alex+Brush:wght@400;700&display=swap"
			rel="stylesheet"
		/>
	</head>
	<body>
		<div class="container my-5">
			<div class="row">
				<div class="col-12 mb-4">
					<h1 class="text-center">Phomemo D30 Printer Web UI</h1>
					<p class="text-center lead">Print custom labels from your browser via Web Bluetooth.</p>
					<hr>
				</div>
			</div>

			<div class="row">
				<!-- Left Column: Controls -->
				<div class="col-lg-6 mb-4">
					<form>
						<div class="card shadow-sm">
							<div class="card-body">
								<h3 class="card-title">Label Content</h3>

								<!-- Tab Navigation -->
								<ul class="nav nav-tabs" id="nav-tab" role="tablist">
									<li class="nav-item" role="presentation">
										<button class="nav-link active" id="nav-text-tab" data-bs-toggle="tab" data-bs-target="#nav-text" type="button" role="tab" aria-controls="nav-text" aria-selected="true">Text</button>
									</li>
									<li class="nav-item" role="presentation">
										<button class="nav-link" id="nav-image-tab" data-bs-toggle="tab" data-bs-target="#nav-image" type="button" role="tab" aria-controls="nav-image" aria-selected="false">Image</button>
									</li>
								</ul>

								<!-- Tab Content -->
								<div class="tab-content pt-3" id="nav-tabContent">

									<!-- Text Tab -->
									<div class="tab-pane fade show active" id="nav-text" role="tabpanel" aria-labelledby="nav-text-tab" tabindex="0">
										<div class="mb-3">
											<label for="inputText" class="form-label">Text to Print</label>
											<textarea class="form-control" id="inputText" rows="3">Hello World!</textarea>
										</div>
										<div class="row mb-3">
											<div class="col-md-6">
												<label for="inputFontSize" class="form-label">Font Size (pt)</label>
												<input type="number" step="1" class="form-control" value="16" id="inputFontSize" />
											</div>
											<div class="col-md-6">
												<label for="fontFamily" class="form-label">Font Family</label>
												<select class="form-select" id="fontFamily">
													<option value="Inter">Inter (Sans-serif)</option>
													<option value="Libre Franklin">Libre Franklin</option>
													<option value="Oswald">Oswald</option>
													<option value="Staatliches">Staatliches</option>
													<option value="Fredoka">Fredoka</option>
													<option value="Baloo 2">Baloo 2 (Handwritten)</option>
													<option value="Libre Baskerville">Libre Baskerville (Serif)</option>
													<option value="JetBrains Mono">JetBrains Mono (Monospace)</option>
													<option value="Alex Brush">Alex Brush (Cursive)</option>
												</select>
											</div>
										</div>

                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="textColor" class="form-label">Text Color (Hex or Name)</label>
                                                <input type="text" class="form-control" id="textColor" value="#000000" />
                                            </div>
                                            <div class="col-md-6">
                                                <label for="backgroundColor" class="form-label">Background Color (Hex or Name)</label>
                                                <input type="text" class="form-control" id="backgroundColor" value="#FFFFFF" />
                                            </div>
                                        </div>

                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="advAlign" class="form-label">Text Alignment</label>
                                                <select class="form-select" id="advAlign">
                                                    <option value="center">Center</option>
                                                    <option value="left">Left</option>
                                                    <option value="right">Right</option>
                                                    <option value="justify">Justify</option>
                                                </select>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="advLineHeight" class="form-label">Line Height</label>
                                                <input type="number" step="0.05" class="form-control" value="1.2" id="advLineHeight" />
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <label for="advMargin" class="form-label">Text Margin (px)</label>
                                                <input type="number" step="1" class="form-control" value="0" id="advMargin" />
                                            </div>
                                            <div class="col-md-6">
                                                <label for="advLetterSpacing" class="form-label">Letter Spacing (px)</label>
                                                <input type="number" step="0.1" class="form-control" value="0" id="advLetterSpacing" />
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox" id="advBold">
                                                    <label class="form-check-label" for="advBold">Bold</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox" id="advItalic">
                                                    <label class="form-check-label" for="advItalic">Italic</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox" id="advUpper">
                                                    <label class="form-check-label" for="advUpper">ALL CAPS</label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-check form-switch">
                                                    <input class="form-check-input" type="checkbox" id="advUnderline">
                                                    <label class="form-check-label" for="advUnderline">Underline</label>
                                                </div>
                                            </div>
                                        </div>
									</div>

									<!-- Image Tab -->
									<div class="tab-pane fade" id="nav-image" role="tabpanel" aria-labelledby="nav-image-tab" tabindex="0">
										<div class="mb-3">
											<label for="inputImage" class="form-label">Upload Image (BMP, JPG, PNG)</label>
											<input class="form-control" type="file" id="inputImage" accept="image/*" />
											<div class="form-text">Note: Image will be converted to 1-bit black/white for printing.</div>
										</div>

										<h5 class="mt-4">Image Processing</h5>
										<div class="row mb-3">
											<div class="col-md-6">
												<label for="ditherAlgorithm" class="form-label">Dithering Algorithm</label>
												<select class="form-select" id="ditherAlgorithm">
													<option value="none">None (Threshold)</option>
													<option value="floydsteinberg">Floyd-Steinberg</option>
													<option value="atkinson">Atkinson</option>
												</select>
											</div>
											<div class="col-md-6">
												<label for="threshold" class="form-label">Threshold (0-255)</label>
												<input type="range" class="form-range" min="0" max="255" value="128" id="threshold" />
											</div>
										</div>

										<div class="row mb-3">
											<div class="col-md-6">
												<label for="brightness" class="form-label">Brightness (-100 to 100)</label>
												<input type="range" class="form-range" min="-100" max="100" value="0" id="brightness" />
											</div>
											<div class="col-md-6">
												<label for="contrast" class="form-label">Contrast (-100 to 100)</label>
												<input type="range" class="form-range" min="-100" max="100" value="0" id="contrast" />
											</div>
										</div>

										<div class="row mb-3">
											<div class="col-md-6">
												<label for="noise" class="form-label">Noise Reduction (0-5)</label>
												<input type="range" class="form-range" min="0" max="5" value="0" id="noise" />
											</div>
											<div class="col-md-6">
												<label for="imageRotation" class="form-label">Image Rotation (°)</label>
												<select class="form-select" id="imageRotation">
													<option value="0">0°</option>
													<option value="90">90°</option>
													<option value="180">180°</option>
													<option value="270">270°</option>
												</select>
											</div>
										</div>

										<h5 class="mt-4">Advanced Pre-processing</h5>
										<div class="row mb-3">
											<div class="col-md-6">
												<div class="form-check form-switch">
													<input class="form-check-input" type="checkbox" id="useGammaCorrection">
													<label class="form-check-label" for="useGammaCorrection">Gamma Correction</label>
												</div>
												<input type="range" class="form-range" min="0.1" max="5.0" step="0.1" value="1.0" id="gamma" disabled />
											</div>
											<div class="col-md-6">
												<div class="form-check form-switch">
													<input class="form-check-input" type="checkbox" id="usePreFiltering">
													<label class="form-check-label" for="usePreFiltering">Pre-Filter (Sharpen/Soften)</label>
												</div>
												<select class="form-select" id="preFilterType" disabled>
													<option value="sharpen">Sharpen</option>
													<option value="gaussian">Gaussian Blur (Soften)</option>
													<option value="edge">Edge Detection</option>
												</select>
											</div>
										</div>
									</div>

								</div>
							</div>
						</div>

						<!-- Print Settings Card -->
						<div class="card shadow-sm mt-4">
							<div class="card-body">
								<h3 class="card-title">Print Settings</h3>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="useBorder">
                                            <label class="form-check-label" for="useBorder">Draw 1-dot Border</label>
                                        </div>
                                    </div>
                                </div>
                                
                                <h5 class="mt-4">Offset (Dot Position)</h5>
								<div class="row mb-3">
									<div class="col-md-6">
										<label for="offsetStep" class="form-label">Step Size (dots)</label>
										<input type="number" step="1" class="form-control" value="8" id="offsetStep" />
									</div>
									<div class="col-md-6 d-flex align-items-end">
                                        <button type="button" class="btn btn-warning w-100" id="offsetReset">Reset Offset</button>
                                    </div>
								</div>

								<div class="row mb-3 text-center">
									<div class="col-4">
                                        <button type="button" class="btn btn-secondary btn-sm" id="offsetUp">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-fill" viewBox="0 0 16 16"><path d="M7.646 2.646l-4 4a.5.5 0 0 0 .708.708L7.5 3.707V13.5a.5.5 0 0 0 1 0V3.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0z"/></svg>
                                        </button>
                                    </div>
                                    <div class="col-4">
                                        <p class="m-0"><small>Current X: <span id="offsetXValue">0</span></small></p>
                                    </div>
                                    <div class="col-4">
                                        <p class="m-0"><small>Current Y: <span id="offsetYValue">0</span></small></p>
                                    </div>
                                </div>
								<div class="row mb-3 text-center">
									<div class="col-4">
                                        <button type="button" class="btn btn-secondary btn-sm" id="offsetLeft">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-left-fill" viewBox="0 0 16 16"><path d="M11.354 1.646l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L8.207 6.5l3.854-3.854a.5.5 0 0 0-.708-.708z"/></svg>
                                        </button>
                                    </div>
                                    <div class="col-4">
                                        <button type="button" class="btn btn-secondary btn-sm" id="offsetDown">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-down-fill" viewBox="0 0 16 16"><path d="M7.646 13.354l-4-4a.5.5 0 0 1 .708-.708L7.5 12.293V2.5a.5.5 0 0 1 1 0v9.793l3.146-3.147a.5.5 0 0 1 .708.708l-4 4a.5.5 0 0 1-.708 0z"/></svg>
                                        </button>
                                    </div>
                                    <div class="col-4">
                                        <button type="button" class="btn btn-secondary btn-sm" id="offsetRight">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-right-fill" viewBox="0 0 16 16"><path d="M4.646 1.646a.5.5 0 0 1 .708 0l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L8.293 6.5 4.646 2.854a.5.5 0 0 1 0-.708z"/></svg>
                                        </button>
                                    </div>
								</div>

                                <h5 class="mt-4">Preview Rotation</h5>
                                <div class="row mb-3" id="previewRotation">
                                    <div class="col-6">
                                        <button type="button" class="btn btn-outline-light w-100" data-rotation="cw90">90° CW</button>
                                    </div>
                                    <div class="col-6">
                                        <button type="button" class="btn btn-outline-light w-100" data-rotation="ccw90">90° CCW</button>
                                    </div>
                                    <div class="col-6 mt-2">
                                        <button type="button" class="btn btn-outline-light w-100" data-rotation="flip">Flip (180°)</button>
                                    </div>
                                    <div class="col-6 mt-2">
                                        <button type="button" class="btn btn-outline-light w-100" data-rotation="none">Reset (0°)</button>
                                    </div>
                                </div>
								
                                <h5 class="mt-4">Label Size (Physical)</h5>
								<div class="row mb-3">
									<div class="col-md-6">
										<div class="input-group">
											<span class="input-group-text">Width (mm)</span>
											<input
												type="number"
												step="1"
												class="form-control"
												value="40"
												aria-label="Width"
												id="inputWidth"
											/>
										</div>
									</div>
									<div class="col-md-6">
										<div class="input-group">
											<span class="input-group-text">Height (mm)</span>
											<input
												type="number"
												step="1"
												class="form-control"
												value="12"
												aria-label="Height"
												id="inputHeight"
											/>
										</div>
									</div>
								</div>

								<div class="d-grid gap-2">
									<button type="submit" class="btn btn-primary btn-lg mt-3">
										Connect & Print to Phomemo D30
									</button>
								</div>
							</div>
						</div>
					</form>
				</div>

				<!-- Right Column: Canvas Preview -->
				<div class="col-lg-6">
					<div class="card shadow-sm" id="previewCard">
						<div class="card-body">
							<h3 class="card-title">Preview</h3>
							<div class="alert alert-info text-center" role="alert">
								<p class="mb-0"><strong>Current Content:</strong> <span id="currentContentType">Text</span></p>
							</div>
							<div class="preview-container">
								<canvas id="canvas"></canvas>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="toast-container position-fixed bottom-0 start-0 p-3">
			<div
				id="errorToast"
				class="toast align-items-center text-bg-danger border-0"
				role="alert"
				aria-live="assertive"
				aria-atomic="true"
			>
				<div class="d-flex">
					<div class="toast-body">
						<span id="errorText"></span>
					</div>
					<button
						type="button"
						class="btn-close btn-close-white me-2 m-auto"
						data-bs-dismiss="toast"
						aria-label="Close"
					></button>
				</div>
			</div>
		</div>

		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/js/bootstrap.bundle.min.js"
			integrity="sha512-7Pi/otdlbbCR+LnW+F7PwFcSDJOuUJB3OxtEHbg4vSMvzvJjde4Po1v4BR9Gdc9aXNUNFVUY+SK51wWT8WF0Gg=="
			crossorigin="anonymous"
			defer
		></script>
		<script type="module" src="index.js"></script>
	</body>
</html>
